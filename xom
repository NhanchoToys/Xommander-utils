#!/bin/bash
# Xommander-utils
# By Tekin-Miz(WorldMoZara)
source lang/en_utf-8.lang
source lang/zh_utf-8.lang
if [ "$LD_PRELOAD" = '/data/data/com.termux/files/usr/lib/libtermux-exec.so' ]
then
    istermux=1
fi
function main(){
    dialog --title "$title" --no-cancel --stderr --menu "$mainmenu_text" 16 55 10 1 "$mainmenu_opt1" 2 "$mainmenu_opt2" 3 "$mainmenu_opt3" 4 "$mainmenu_exit" 2>$PREFIX/tmp/mainopt
    main_opt=$(cat $PREFIX/tmp/mainopt)
    case "$main_opt" in
        1)
            tools
            ;;
        2)
            vision
            ;;
        3)
            extras
            ;;
        4)
            dialog --clear
            clear -x
            exit 0
            ;;
        *)
            ;;
    esac
    rm $PREFIX/tmp/mainopt
}
function tools(){
    dialog --title "$title" --stderr --menu "$toolmenu_text" 16 55 10 1 "$toolmenu_opt1" 2 "$toolmenu_opt2" 2>$PREFIX/tmp/toolopt
    if [ $? -ne 0 ]
    then
        rm $PREFIX/tmp/toolopt
        main
    else
        tool_opt=$(cat $PREFIX/tmp/toolopt)
        case $tool_opt in
            1)
                ;;
            2)
                ;;
            *)
                ;;
        esac
        rm $PREFIX/tmp/toolopt
    fi
}
function vision(){
    dialog --title "$title" --stderr --menu "$toolmenu_text" 16 55 10 1 "$visimenu_opt1" 2 "$visimenu_opt2" 3 "$visimenu_opt3" 2>$PREFIX/tmp/visiopt
    if [ $? -ne 0 ]
    then
        rm $PREFIX/tmp/visiopt
        main
    else
        visi_opt=$(cat $PREFIX/tmp/visiopt)
        case $visi_opt in
            1)
                uvimrc awesome
                ;;
            2)
                uvimrc basic
                ;;
            3)
                dialog --title "$title" --stderr --yesno "$uvimrc_warn" 16 55
                if [ $? -eq 0 ]
                then
                    git clone https://github.com/gpakosz/.tmux.git ~/.tmux/
                    ln -s -f .tmux/.tmux.conf ~/.tmux.conf
                    cp .tmux/.tmux.conf.local ~/
                fi
                vision
                ;;
            *)
                ;;
        esac
        rm $PREFIX/tmp/visiopt
    fi
}
function extras(){
    dialog --title "$title" --stderr --menu "$extramenu_text" 16 55 10 1 "$extramenu_opt1" 2 "$extramenu_opt2" 2>$PREFIX/tmp/extraopt
    if [ $? -ne 0 ]
    then
        rm $PREFIX/tmp/extraopt
        main
    else
        extra_opt=$(cat $PREFIX/tmp/extraopt)
        case $extra_opt in
            1)
                if [ $istermux -eq 1 ]
                then
                    termux
                else
                    dialog --title "$title" --defaultno --stderr --yesno "$termux_warn" 16 55
                    if [ $? -eq 0 ]
                    then
                        termux
                    else
                        extras
                    fi
                    :
                fi
                ;;
            2)
                ;;
            *)
                ;;
        esac
        rm $PREFIX/tmp/extraopt
    fi
}
function uvimrc(){
    dialog --title "$title" --stderr --yesno "$uvimrc_warn" 16 55
    if [ $? -eq 0 ]
    then
        case $1 in
            awesome)
                git clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime
                sh ~/.vim_runtime/install_awesome_vimrc.sh
                ;;
            basic)
                git clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime
                sh ~/.vim_runtime/install_basic_vimrc.sh
                ;;
            *)
                ;;
        esac
    fi
    vision
}
function termux(){
    :
}
main
